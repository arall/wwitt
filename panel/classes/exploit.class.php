<?php
class Exploit extends Model {

	var $vuln;
	var $host;
	var $port;
	var $virtualHost;

	var $status;
	var $data;

	public function __construct($vuln, $host, $port, $virtualHost){
		$this->vuln = $vuln;
		$this->host = $host;
		$this->port = $port;
		$this->virtualHost = $virtualHost;
	}

	public function preRun(){
		//Check if the target is alive etc
		return true;
	}

	public function run(){}
	public function save(){
		//Save the data creating a new Vuln_host entry
		$vuln_host = Vuln_host::getVuln_hostByVulnIdIpPortVirtualHostId(
			$this->vuln->id,
			$this->host->ip,
			$this->port,
			$this->virtualHost
		);
		if(!$vuln_host->id){
			$vuln_host = new Vuln_host();
		}
		$vuln_host->vulnId = $this->vuln->id;
		$vuln_host->host = $this->host->ip;
		$vuln_host->port = $this->port;
		$vuln_host->virtualHost = $this->virtualHost;
		$vuln_host->status = $this->status;
		$vuln_host->data = $this->data;
		if($vuln_host->id){
			return $vuln_host->update();
		}else{
			return $vuln_host->insert();
		}
	}
}
?>