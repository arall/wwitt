<?php
class Exploit extends Model {

	var $vuln;
	var $host;
	var $port;
	var $virtualhost;

	var $status;
	var $data;

	public function __construct($vuln, $host, $port, $virtualhost){
		$this->vuln = $vuln;
		$this->host = $host;
		$this->port = $port;
		$this->virtualhost = $virtualhost;
	}

	public function preRun(){
		//Check if the target is alive etc
		return true;
	}

	public function run(){}
	public function save(){
		//Save the data creating a new Vuln_host entry
		$vulnHost = VulnHost::getVulnHostByVulnIpPortHost(
			$this->vuln->id,
			$this->host->ip,
			$this->port,
			$this->virtualHost->host
		);
		if(!$vulnHost->id){
			$vulnHost = new VulnHost();
		}
		$vulnHost->vuln = $this->vuln->module;
		$vulnHost->ip = $this->host->ip;
		$vulnHost->port = $this->port;
		$vulnHost->host = $this->virtualHost->host;
		$vulnHost->status = $this->status;
		$vulnHost->data = $this->data;
		if($vulnHost->id){
			return $vulnHost->update();
		}else{
			return $vulnHost->insert();
		}
	}
}
?>