<?php
class Exploit extends Model {

	var $vuln;
	var $host;
	var $port;
	var $virtualhost;

	var $status;
	var $data;

	public function __construct($vuln, $host, $port, $virtualhost){
		$this->vuln = $vuln;
		$this->host = $host;
		$this->port = $port;
		$this->virtualhost = $virtualhost;
	}

	public function preRun(){
		//Check if the target is alive etc
		return true;
	}

	public function run(){}
	public function save(){
		//Save the data creating a new Vuln_host entry
		$vuln_host = Vuln_host::getVulnHostByVulnIpPortHost(
			$this->vuln->id,
			$this->host->ip,
			$this->port,
			$this->virtualHost->host
		);
		if(!$vuln_host->id){
			$vuln_host = new Vuln_host();
		}
		$vuln_host->vuln = $this->vuln->module;
		$vuln_host->host = $this->host->ip;
		$vuln_host->port = $this->port;
		$vuln_host->virtualHost = $this->virtualHost->host;
		$vuln_host->status = $this->status;
		$vuln_host->data = $this->data;
		if($vuln_host->id){
			return $vuln_host->update();
		}else{
			return $vuln_host->insert();
		}
	}
}
?>